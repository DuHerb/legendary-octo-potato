# pullIssue Slash Command

Retrieve GitHub issue, create development branch, and prepare immediate work environment: $ARGUMENTS

## Purpose
Fetch GitHub issue details, create a dedicated development branch from the latest development branch, generate an issue-specific planning document, and prepare for immediate development work within the current Claude Code session.

## Usage Examples
- `/pullIssue 7` - Get issue #7, create branch, and start work
- `/pullIssue Phase 2` - Find all issues related to Phase 2
- `/pullIssue database` - Find all issues containing "database"
- `/pullIssue open` - List all open issues
- `/pullIssue` - List recent issues (default if no $ARGUMENTS)

## Command Steps

Follow these steps to prepare issue for development: $ARGUMENTS

### 1. Determine Request Type
Analyze "$ARGUMENTS" to determine the appropriate action:
- **Specific Issue**: If "$ARGUMENTS" is a number, prepare for immediate development
- **Search Query**: If text, use `gh issue list --search "$ARGUMENTS" --state all`
- **Status Filter**: If "open", "closed", or "all", use `gh issue list --state $ARGUMENTS`
- **Default**: If no $ARGUMENTS provided, use `gh issue list --state open --limit 10`

### 2. For Specific Issue Numbers - Full Development Setup

#### 2.1 Get Issue Details
```bash
gh issue view $ARGUMENTS
```

#### 2.2 Ensure Latest Development Branch
```bash
# Switch to main/development branch and pull latest
git checkout main
git pull origin main

# Alternative: if project uses 'develop' branch
# git checkout develop
# git pull origin develop
```

#### 2.3 Create Development Branch
```bash
# Generate branch name from issue
BRANCH_NAME="issue-$ARGUMENTS-$(gh issue view $ARGUMENTS --json title -q .title | tr '[:upper:]' '[:lower:]' | sed 's/[^a-z0-9]/-/g' | sed 's/--*/-/g' | sed 's/^-\|-$//g' | cut -c1-50)"

# Create and checkout new branch from latest main/develop
git checkout -b "$BRANCH_NAME"

# Ensure we're on the new feature branch
echo "âœ… Created and switched to branch: $BRANCH_NAME"
git branch --show-current
```

#### 2.4 Create Issue Planning Directory
```bash
# Ensure specs/issues directory exists
mkdir -p .claude/specs/issues

# Create issue-specific planning file
ISSUE_FILE=".claude/specs/issues/issue-$ARGUMENTS.md"
```

#### 2.5 Generate Issue Planning Document
Create comprehensive planning document at `.claude/specs/issues/issue-$ARGUMENTS.md`:

```markdown
# Issue #$ARGUMENTS: [Issue Title]

**Status**: In Progress | **Branch**: [branch-name] | **Created**: [date]

## Issue Summary
[Extract from GitHub issue description]

## Technical Specifications Required
[List relevant .claude/specs files based on issue content]

## Implementation Plan

### Phase Information
[Extract phase info if applicable]

### Task Breakdown
[Convert issue checkboxes to actionable tasks with status tracking]

### Dependencies
[List prerequisites and related issues]

## Development Guidelines

### Critical Requirements
[Extract critical requirements from issue - DAO pattern, TypeScript, etc.]

### Success Criteria
[Copy success criteria from issue]

## Progress Tracking

### Completed Tasks
- [ ] [Task list will be updated as work progresses]

### Current Focus
[What to work on next]

### Blockers
[Any current blockers or questions]

## Technical Notes

### Architecture Decisions
[Document decisions made during implementation]

### Code Patterns Used
[Track patterns and approaches used]

### Testing Approach
[Document testing strategy for this issue]

## Links and References
- **GitHub Issue**: https://github.com/[repo]/issues/$ARGUMENTS
- **Related Specs**: [List of relevant specification files]
- **Related Issues**: [Any dependencies or related work]

---
Last Updated: [date]
Generated by Claude Code `/pullIssue` command
```

#### 2.6 Update Issue with Development Status
```bash
gh issue comment $ARGUMENTS --body "ðŸš€ **Development Started**

**Branch**: \`$BRANCH_NAME\` (created from latest main)
**Planning Document**: \`.claude/specs/issues/issue-$ARGUMENTS.md\`

Development is now in progress. All work will be tracked in the issue-specific planning document."
```

#### 2.7 Update plan.md with Issue Progress
```bash
# Update plan.md to show issue in progress
# Add issue reference, branch name, and status
# Mark relevant phase/section as "IN PROGRESS"
# Include task progress updates
echo "ðŸ“‹ Update plan.md to reflect issue #$ARGUMENTS is in progress"
```

### 3. For Search/List Operations - Analysis Only

#### 3.1 Execute Search
```bash
# For search terms
gh issue list --search "$ARGUMENTS" --state all --limit 20

# For status filters  
gh issue list --state $ARGUMENTS --limit 15
```

#### 3.2 Analyze Results
[Provide analysis without creating branches or planning docs]

## Response Format

### For Specific Issue (Development Setup)
```markdown
# ðŸš€ Issue #$ARGUMENTS Ready for Development

**Issue**: [Title]
**Status**: Ready for Development | **Branch**: [branch-name] (from latest main)
**Planning Doc**: `.claude/specs/issues/issue-$ARGUMENTS.md`

## Development Environment Setup âœ…
- âœ… Issue details retrieved
- âœ… Latest main branch pulled
- âœ… Development branch created: `[branch-name]`
- âœ… **Switched to feature branch** (confirmed working on correct branch)
- âœ… Issue planning document generated
- âœ… GitHub issue updated with development status
- âœ… plan.md updated to reflect issue in progress

## Quick Context
[Brief summary of what this issue involves]

## Next Actions
[Immediate next steps based on issue content]

## Files to Focus On
[Key files that will likely need changes]

## Ready to Code! 
Your development environment is ready. The issue planning document contains comprehensive context and will be updated as you progress.

**IMPORTANT**: Ensure all work is committed to the feature branch `[branch-name]`, not main.

Start with: [specific first task]
```

### For Search/List Operations
```markdown
# Issue Analysis for: "$ARGUMENTS"

## Found Issues ([count])

### #[number]: [Title]
**Labels**: [labels] | **Created**: [timeframe] | **Status**: [Open/Closed]
Brief: [First sentence of description]

[Repeat for each issue found]

## Work Status Analysis
- **Ready for Development**: [count] issues that can be started immediately
- **In Progress**: [count] issues with active development
- **Blocked**: [count] issues waiting on dependencies

## Recommendations
To start work on any issue, use: `/pullIssue [issue-number]`
```

## Advanced Features

### 1. Issue Planning Document Management
- **Living Documentation**: Planning docs are updated throughout development
- **Progress Tracking**: Task completion tracked in real-time
- **Decision Recording**: Architecture decisions documented as they're made
- **Reference Hub**: Central location for all issue-related information

### 2. Intelligent Context Extraction
- **Specification Mapping**: Automatically identify relevant .claude/specs files
- **Dependency Analysis**: Extract and highlight issue dependencies
- **Task Breakdown**: Convert high-level requirements into actionable tasks
- **Pattern Recognition**: Identify code patterns and approaches needed

### 3. Development Workflow Integration
- **Branch Management**: Consistent branch naming and creation from latest main
- **GitHub Integration**: Automatic issue commenting and status updates
- **Claude Code Optimization**: Immediate work readiness within current session
- **Progress Persistence**: Planning docs survive across Claude Code sessions

## Directory Structure

```
.claude/
â”œâ”€â”€ specs/
â”‚   â”œâ”€â”€ issues/                    # Issue-specific planning documents
â”‚   â”‚   â”œâ”€â”€ issue-7.md            # Phase 2 Database Layer
â”‚   â”‚   â”œâ”€â”€ issue-8.md            # Future issue planning
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ architecture.md           # Project-wide specs
â”‚   â”œâ”€â”€ database-schema.md
â”‚   â””â”€â”€ ...
â””â”€â”€ commands/
    â”œâ”€â”€ pullIssue.md              # This command
    â””â”€â”€ ...
```

## Error Handling

- **Issue Not Found**: Clear error message with suggestion to check issue number
- **Branch Already Exists**: Offer to switch to existing branch or create with suffix
- **Git Pull Fails**: Handle merge conflicts or connection issues
- **GitHub CLI Errors**: Check authentication and provide troubleshooting steps
- **File Creation Errors**: Provide manual creation instructions

## Integration Points

- **With pushIssue**: Issues created by pushIssue can be immediately pulled for development
- **With closeIssue**: Planning docs provide context for completion verification
- **With plan.md**: Issue planning docs complement project-wide planning
- **With /prime**: New agents can read issue planning docs for context

## Workflow Benefits

### Immediate Development
- No manual worktree navigation required
- Work starts immediately in current Claude Code session
- All context available in planning document
- Always starts from latest codebase
- **Automatic branch switching** ensures work happens on correct feature branch

### Better Organization
- Each issue has dedicated planning and tracking
- Clear separation between project-wide and issue-specific concerns
- Persistent documentation across sessions
- Consistent branching from main development line

### Enhanced Collaboration
- Planning docs can be shared and reviewed
- Clear development status visible in GitHub
- Comprehensive context for code reviews
- Clean branch history from main

## Remember

- Issue planning documents are living documents - update them as you work
- Use consistent branch naming for easy identification
- Always update GitHub issue with development progress
- Planning docs should be detailed enough for another developer to continue work
- Branches are always created from the latest main/develop to avoid conflicts
- **CRITICAL**: Always verify you're working on the feature branch, not main
- All commits should go to the feature branch for proper PR workflow